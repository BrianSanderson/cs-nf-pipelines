import pandas as pd
import sys 

df = pd.read_csv(sys.argv[1], sep='\t')

df[['Allele','Consequence','IMPACT','SYMBOL','Gene','Feature_type','Feature','BIOTYPE','EXON','INTRON','HGVSc','HGVSp','cDNA_position','CDS_position','Protein_position','Amino_acids','Codons','Existing_variation','DISTANCE','STRAND','FLAGS','SYMBOL_SOURCE','HGNC_ID','REFSEQ_MATCH','REFSEQ_OFFSET','SOURCE','HGVS_OFFSET','AF_1000G','AFR_AF_1000G','AMR_AF_1000G','EAS_AF_1000G','EUR_AF_1000G','SAS_AF_1000G','gnomADe_AF','gnomADe_AFR_AF','gnomADe_AMR_AF','gnomADe_ASJ_AF','gnomADe_EAS_AF','gnomADe_FIN_AF','gnomADe_NFE_AF','gnomADe_OTH_AF','gnomADe_SAS_AF','MAX_AF','MAX_AF_POPS','CLIN_SIG','SOMATIC','PHENO','ada_score','rf_score','MaxEntScan_alt','MaxEntScan_diff','MaxEntScan_ref','CADD_phred','FATHMM_pred','GERP++_RS','LRT_pred','MetaSVM_pred','MutationAssessor_pred','MutationTaster_pred','PROVEAN_pred','Polyphen2_HVAR_pred','PrimateAI_pred','REVEL_score','SIFT4G_pred','SIFT_pred','fathmm-MKL_coding_pred','phyloP100way_vertebrate','CosmicCoding','CosmicCoding_GENOMIC_ID','CosmicCoding_LEGACY_ID','CosmicCoding_CNT','CosmicCoding_CDS','CosmicCoding_AA','CosmicNonCoding','CosmicNonCoding_GENOMIC_ID','CosmicNonCoding_LEGACY_ID','CosmicNonCoding_CNT','CosmicNonCoding_CDS','CosmicNonCoding_AA','NYGC','NYGC_AF','NYGC_Samples','NYGC_AC_Het','NYGC_AC_Hom','CLN_Overlap','CLN_Overlap_CLIN_ID','CLN_Overlap_CLNSIG','CLN_Overlap_CLNREVSTAT','CLN_Overlap_CLNDN','CLN_Exact','CLN_Exact_CLIN_ID','CLN_Exact_CLNSIG','CLN_Exact_CLNREVSTAT','CLN_Exact_CLNDN','GnomadExomes','GnomadExomes_AF','GnomadExomes_nhomalt','GnomadGenomes','GnomadGenomes_AF','GnomadGenomes_nhomalt','CHD_GENES','CHD_GENES_GENE','CHD_EVOLVING','CHD_EVOLVING_GENE','chd_whitelist','chd_whitelist_END','INTRONIC','INTRONIC_INTRONIC','CLINVAR_INTRONIC','CLINVAR_INTRONIC_INTRONIC','mm','mm_GENE','mm_HGVSG','mm_MMCNT1','mm_MMCNT2','mm_MMCNT3','mm_MMID3','mm_MMURI3','SPLICEAI','SPLICEAI_DS_AG','SPLICEAI_DS_AL','SPLICEAI_DS_DG','SPLICEAI_DS_DL','PLI','PLI_pLI','PLI_mis_z','Domino','Domino_Domino_Score','AR','AR_AR_GENE','ACMG59','ACMG59_GENE','ACMG59_DISEASE','DIALS','DIALS_DIALS_GENE','PGx','PGx_pgx_rsid','IMMUNO','IMMUNO_IMMUNO_Gene','NEURO','NEURO_NEURO_Gene','CARDIO','CARDIO_CARDIO_Gene','N19','N19_NYGC_CUR','R19','R19_NYGC_REPORTED_SAMPLE','R19_NYGC_CLASS','R19_NYGC_DISEASE']] = df['CSQ'].str.split('|',expand=True)
df[['CancerGeneCensus_Tier','Hallmark','Somatic','Germline','Tumour_Types_Somatic','Tumour_Types_Germline','Cancer_Syndrome','Tissue_Type','Molecular_Genetics','Role_in_Cancer','Mutation_Types']] = df['CancerGeneCensus'].str.split('|',expand=True)
df[['MUTATION_ID','GENOMIC_MUTATION_ID','Drug_Name','CosmicResistanceMutation_Tier']] = df['CosmicResistanceMutation'].str.split('|',expand=True)
df.drop(['CSQ', 'CancerGeneCensus', 'CosmicResistanceMutation'], axis=1, inplace = True)

df.to_csv(sys.argv[2], sep='\t', index = False)